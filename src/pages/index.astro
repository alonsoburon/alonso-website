---
import { getCollection } from 'astro:content';
import Layout from '../layouts/Layout.astro';

const posts = await getCollection('blog');
const recentPosts = posts.slice(0, 3);

function formatDate(dateString: string) {
  const date = new Date(dateString);
  return date.toLocaleDateString('en-US', {
    year: 'numeric',
    month: 'long',
    day: 'numeric'
  });
}
---

<Layout title="Alonso - Data Team Lead" description="Data Engineer and Team Lead at Datawalt. From music student to leading LATAM's best data extraction team.">
  <div class="container">
    <!-- Hero Section -->
    <section class="hero">
      <div class="hero-content">
        <h1>Data Team Lead at Datawalt</h1>
        <p class="hero-subtitle">Building LATAM's best data extraction platform</p>
        <p class="hero-description">
          Former music student who accidentally became a data engineer by helping his girlfriend with Stata homework. 
          Now leading Datawalt's first Data Engineering Cell, processing millions of records daily across LATAM. 
          Still figuring it out, but making it work.
        </p>
        <div class="hero-buttons">
          <a href="/blog" class="btn btn-primary">Read My Story</a>
          <a href="/contact" class="btn btn-secondary">Get In Touch</a>
        </div>
      </div>
    </section>

    <!-- Interactive Data Pipeline -->
    <section class="pipeline-demo">
      <h2>Live Data Pipeline</h2>
      <div class="pipeline-container">
        <div class="pipeline-node" data-node="source" onclick="showNodeDetails('source')">
          <div class="node-header">
            <div class="node-status status-success"></div>
            <div class="node-icon">üìä</div>
          </div>
          <div class="node-content">
            <h3>Data Sources</h3>
            <p>APIs ‚Ä¢ Databases ‚Ä¢ Files</p>
            <div class="node-metrics">
              <span class="metric">Multiple sources</span>
              <span class="metric">Real-time validation</span>
            </div>
          </div>
        </div>

        <div class="pipeline-connection">
          <div class="connection-line"></div>
          <div class="data-flow"></div>
        </div>

        <div class="pipeline-node" data-node="etl" onclick="showNodeDetails('etl')">
          <div class="node-header">
            <div class="node-status status-success"></div>
            <div class="node-icon">‚ö°</div>
          </div>
          <div class="node-content">
            <h3>ETL Engine</h3>
            <p>Python ‚Ä¢ Power BI ‚Ä¢ Automation</p>
            <div class="node-metrics">
              <span class="metric">Custom software</span>
              <span class="metric">40% more efficient</span>
            </div>
          </div>
        </div>

        <div class="pipeline-connection">
          <div class="connection-line"></div>
          <div class="data-flow"></div>
        </div>

        <div class="pipeline-node" data-node="warehouse" onclick="showNodeDetails('warehouse')">
          <div class="node-header">
            <div class="node-status status-success"></div>
            <div class="node-icon">üóÑÔ∏è</div>
          </div>
          <div class="node-content">
            <h3>Data Warehouse</h3>
            <p>PostgreSQL ‚Ä¢ Unified Architecture</p>
            <div class="node-metrics">
              <span class="metric">Scalable</span>
              <span class="metric">High availability</span>
            </div>
          </div>
        </div>

        <div class="pipeline-connection">
          <div class="connection-line"></div>
          <div class="data-flow"></div>
        </div>

        <div class="pipeline-node" data-node="analytics" onclick="showNodeDetails('analytics')">
          <div class="node-header">
            <div class="node-status status-success"></div>
            <div class="node-icon">üìà</div>
          </div>
          <div class="node-content">
            <h3>Analytics Layer</h3>
            <p>Power BI ‚Ä¢ Dashboards ‚Ä¢ KPIs</p>
            <div class="node-metrics">
              <span class="metric">Multiple dashboards</span>
              <span class="metric">Automated reports</span>
            </div>
          </div>
        </div>
      </div>

      <div class="pipeline-details" id="nodeDetails">
        <div class="details-content">
          <h3 id="detailsTitle">Click a node to see details</h3>
          <p id="detailsDescription">Select any pipeline component to view its configuration and performance metrics.</p>
        </div>
      </div>
    </section>

    <!-- Experience Section -->
    <section class="experience">
      <h2>Professional Experience</h2>
      <div class="timeline">
        <div class="timeline-item">
          <div class="timeline-marker"></div>
          <div class="timeline-content">
            <h3>Data Team Lead</h3>
            <p class="company">Datawalt</p>
            <p class="period">May 2025 - Present</p>
            <ul>
              <li>Led the creation of software to unify and scale corporate information management</li>
              <li>Founded and lead the company's first Data Engineering Cell</li>
              <li>Manage a team focused on improving software integrations and creating new ones</li>
              <li>Goal: build the best data extraction platform in LATAM</li>
            </ul>
          </div>
        </div>
        <div class="timeline-item">
          <div class="timeline-marker"></div>
          <div class="timeline-content">
            <h3>BI Development Engineer</h3>
            <p class="company">Datawalt</p>
            <p class="period">May 2024 - May 2025</p>
            <ul>
              <li>Developed scalable Business Intelligence solutions</li>
              <li>Managed projects and clients with a focus on results</li>
              <li>Combined technical and management skills for growth</li>
            </ul>
          </div>
        </div>
        <div class="timeline-item">
          <div class="timeline-marker"></div>
          <div class="timeline-content">
            <h3>Data Science Student</h3>
            <p class="company">IU International University of Applied Sciences</p>
            <p class="period">March 2024 - February 2027</p>
            <ul>
              <li>Studying Bachelor of Applied Science in Data Science</li>
              <li>Focus on machine learning, statistics, and data analysis</li>
              <li>Developing practical projects in Python and BI tools</li>
            </ul>
          </div>
        </div>
        <div class="timeline-item">
          <div class="timeline-marker"></div>
          <div class="timeline-content">
            <h3>Associate's Degree</h3>
            <p class="company">Pontificia Universidad Cat√≥lica de Chile</p>
            <p class="period">September 2023 - June 2024</p>
            <ul>
              <li>Completed Associate's degree in data analysis</li>
              <li>Specialization in visualization tools and BI</li>
              <li>Final projects in Python and SQL</li>
            </ul>
          </div>
        </div>
        <div class="timeline-item">
          <div class="timeline-marker"></div>
          <div class="timeline-content">
            <h3>Stata and Python Private Tutor</h3>
            <p class="company">Freelance</p>
            <p class="period">August 2021 - January 2024</p>
            <ul>
              <li>Private tutoring in data analysis using Stata and Python</li>
              <li>Taught students from the Economics and Business Faculty</li>
              <li>Developed communication and teaching skills</li>
            </ul>
          </div>
        </div>
      </div>
    </section>

    <!-- Recent Posts -->
    <section class="recent-posts">
      <h2>Latest Articles</h2>
      <div class="posts-grid">
        {recentPosts.map((post) => (
          <article class="post-card">
            <h3><a href={`/blog/${post.slug}`}>{post.data.title}</a></h3>
            <p class="post-meta">{formatDate(post.data.date)}</p>
            <p>{post.data.description || 'Article about data engineering and analysis.'}</p>
          </article>
        ))}
      </div>
      <div class="text-center">
        <a href="/blog" class="btn btn-outline">View All Articles</a>
      </div>
    </section>
  </div>

  <style>
    /* Hero Section */
    .hero {
      text-align: center;
      padding: 4rem 0;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      margin: -2rem 0 4rem 0;
      border-radius: 0 0 0 0;
    }

    .hero-content {
      max-width: 800px;
      margin: 0 auto;
      padding: 0 1rem;
    }

    .hero h1 {
      font-size: 3.5rem;
      font-weight: 700;
      margin-bottom: 1rem;
    }

    .hero-subtitle {
      font-size: 1.5rem;
      font-weight: 300;
      margin-bottom: 1rem;
      opacity: 0.9;
    }

    .hero-description {
      font-size: 1.1rem;
      margin-bottom: 2rem;
      opacity: 0.8;
      line-height: 1.7;
    }

    .hero-buttons {
      display: flex;
      gap: 1rem;
      justify-content: center;
      flex-wrap: wrap;
    }

    /* Buttons */
    .btn {
      display: inline-block;
      padding: 0.75rem 1.5rem;
      border-radius: 0.5rem;
      text-decoration: none;
      font-weight: 600;
      transition: all 0.3s;
      border: 2px solid transparent;
    }

    .btn-primary {
      background: white;
      color: #667eea;
    }

    .btn-primary:hover {
      background: #f8f9fa;
      transform: translateY(-2px);
    }

    .btn-secondary {
      background: transparent;
      color: white;
      border-color: white;
    }

    .btn-secondary:hover {
      background: white;
      color: #667eea;
    }

    .btn-outline {
      background: transparent;
      color: #58a6ff;
      border-color: #58a6ff;
    }

    .btn-outline:hover {
      background: #58a6ff;
      color: white;
    }

    /* Sections */
    section {
      margin-bottom: 4rem;
    }

    h2 {
      font-size: 2.5rem;
      font-weight: 700;
      text-align: center;
      margin-bottom: 3rem;
      color: #f0f6fc;
    }

    /* Interactive Pipeline Section */
    .pipeline-demo {
      padding: 4rem 0;
      background: #0f172a;
      color: white;
    }

    .pipeline-demo h2 {
      text-align: center;
      font-size: 2.5rem;
      font-weight: 700;
      color: #f1f5f9;
      margin-bottom: 3rem;
    }

    .pipeline-container {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0.5rem;
      max-width: 1400px;
      margin: 0 auto 3rem;
      padding: 0 1rem;
    }

    .pipeline-node {
      background: #1e293b;
      border: 2px solid #334155;
      border-radius: 12px;
      padding: 1.25rem;
      width: 280px;
      transition: all 0.3s ease;
      cursor: pointer;
      position: relative;
      overflow: hidden;
      flex-shrink: 0;
    }

    .pipeline-node:hover {
      border-color: #10b981;
      box-shadow: 0 0 20px rgba(16, 185, 129, 0.3);
      transform: translateY(-2px);
    }

    .pipeline-node.active {
      border-color: #10b981;
      box-shadow: 0 0 20px rgba(16, 185, 129, 0.5);
    }

    .node-header {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      margin-bottom: 1rem;
    }

    .node-status {
      width: 12px;
      height: 12px;
      border-radius: 50%;
      animation: pulse 2s infinite;
    }

    .status-success {
      background: #10b981;
      box-shadow: 0 0 10px rgba(16, 185, 129, 0.5);
    }

    .node-icon {
      font-size: 1.5rem;
    }

    .node-content h3 {
      font-size: 1.125rem;
      font-weight: 600;
      color: #f1f5f9;
      margin-bottom: 0.5rem;
    }

    .node-content p {
      color: #94a3b8;
      font-size: 0.875rem;
      margin-bottom: 1rem;
    }

    .node-metrics {
      display: flex;
      flex-direction: column;
      gap: 0.25rem;
    }

    .metric {
      background: #334155;
      color: #10b981;
      padding: 0.25rem 0.5rem;
      border-radius: 4px;
      font-size: 0.75rem;
      font-weight: 500;
      text-align: center;
    }

    .pipeline-connection {
      display: flex;
      align-items: center;
      position: relative;
      width: 30px;
      height: 4px;
      flex-shrink: 0;
    }

    .connection-line {
      width: 100%;
      height: 2px;
      background: #334155;
      position: relative;
    }

    .data-flow {
      position: absolute;
      width: 8px;
      height: 8px;
      background: #10b981;
      border-radius: 50%;
      animation: flow 3s linear infinite;
      box-shadow: 0 0 10px rgba(16, 185, 129, 0.8);
    }

    .pipeline-details {
      background: #1e293b;
      border: 1px solid #334155;
      border-radius: 12px;
      padding: 2rem;
      max-width: 800px;
      margin: 0 auto;
    }

    .details-content h3 {
      color: #f1f5f9;
      font-size: 1.5rem;
      font-weight: 600;
      margin-bottom: 1rem;
    }

    .details-content p {
      color: #94a3b8;
      line-height: 1.6;
    }

    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.5; }
    }

    @keyframes flow {
      0% { left: -10px; }
      100% { left: 100%; }
    }

    /* Responsive */
    @media (max-width: 1200px) {
      .pipeline-container {
        flex-wrap: wrap;
        gap: 1rem;
      }
      
      .pipeline-node {
        width: calc(50% - 1rem);
        min-width: 250px;
      }
      
      .pipeline-connection {
        width: 100%;
        height: 30px;
        transform: rotate(90deg);
      }
    }

    @media (max-width: 768px) {
      .pipeline-container {
        flex-direction: column;
        gap: 1.5rem;
      }
      
      .pipeline-node {
        width: 100%;
        max-width: 300px;
        margin: 0 auto;
      }
      
      .pipeline-connection {
        transform: rotate(90deg);
        width: 4px;
        height: 40px;
      }
    }

    /* Experience Section */
    .timeline {
      position: relative;
      max-width: 800px;
      margin: 0 auto;
    }

    .timeline::before {
      content: '';
      position: absolute;
      left: 2rem;
      top: 0;
      bottom: 0;
      width: 2px;
      background: #21262d;
    }

    .timeline-item {
      position: relative;
      margin-bottom: 3rem;
      padding-left: 5rem;
    }

    .timeline-marker {
      position: absolute;
      left: 1.25rem;
      top: 0.5rem;
      width: 1.5rem;
      height: 1.5rem;
      background: #58a6ff;
      border-radius: 50%;
      border: 4px solid #0d1117;
      box-shadow: 0 0 0 4px #21262d;
    }

    .timeline-content {
      background: #161b22;
      padding: 2rem;
      border-radius: 1rem;
      box-shadow: 0 4px 6px rgba(0,0,0,0.3);
      border: 1px solid #21262d;
    }

    .timeline-content h3 {
      font-size: 1.5rem;
      font-weight: 600;
      margin-bottom: 0.5rem;
      color: #f0f6fc;
    }

    .company {
      font-weight: 600;
      color: #58a6ff;
      margin-bottom: 0.25rem;
    }

    .period {
      color: #8b949e;
      font-size: 0.875rem;
      margin-bottom: 1rem;
    }

    .timeline-content ul {
      list-style: none;
      padding: 0;
    }

    .timeline-content li {
      position: relative;
      padding-left: 1.5rem;
      margin-bottom: 0.5rem;
    }

    .timeline-content li::before {
      content: '‚ñ∏';
      position: absolute;
      left: 0;
      color: #58a6ff;
      font-weight: bold;
    }

    /* Recent Posts */
    .posts-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
      gap: 2rem;
      margin-bottom: 2rem;
    }

    .post-card {
      background: #161b22;
      padding: 2rem;
      border-radius: 1rem;
      box-shadow: 0 4px 6px rgba(0,0,0,0.3);
      border: 1px solid #21262d;
      transition: transform 0.3s, box-shadow 0.3s;
    }

    .post-card:hover {
      transform: translateY(-4px);
      box-shadow: 0 8px 25px rgba(0,0,0,0.4);
      border-color: #58a6ff;
    }

    .post-card h3 {
      font-size: 1.25rem;
      font-weight: 600;
      margin-bottom: 0.5rem;
    }

    .post-card h3 a {
      color: #f0f6fc;
      text-decoration: none;
    }

    .post-card h3 a:hover {
      color: #58a6ff;
    }

    .post-meta {
      color: #8b949e;
      font-size: 0.875rem;
      margin-bottom: 1rem;
    }

    .text-center {
      text-align: center;
    }

    /* Responsive */
    @media (max-width: 768px) {
      .hero h1 {
        font-size: 2.5rem;
      }

      .hero-subtitle {
        font-size: 1.25rem;
      }

      .hero-buttons {
        flex-direction: column;
        align-items: center;
      }

      .timeline::before {
        left: 1rem;
      }

      .timeline-item {
        padding-left: 3rem;
      }

      .timeline-marker {
        left: 0.25rem;
      }

      .posts-grid {
        grid-template-columns: 1fr;
      }
    }
  </style>

  <script is:inline>
    const nodeDetails = {
      source: {
        title: "Data Sources",
        description: "Integrated multiple corporate data sources to unify Datawalt's data platform. Developed custom connectors for legacy systems and REST APIs. Implemented real-time validation and automated data quality controls to ensure information integrity."
      },
      etl: {
        title: "ETL Engine",
        description: "Led the creation of homogeneous data management software at the corporate level. Automated extraction, transformation, and loading processes using Python and BI tools. Optimized pipelines to improve efficiency and reduce processing times by 40%."
      },
      warehouse: {
        title: "Data Warehouse",
        description: "Designed and managed Datawalt's unified data architecture. Implemented scalable storage solutions using PostgreSQL and BI systems. Maintained high availability and optimized queries to improve report and dashboard performance."
      },
      analytics: {
        title: "Analytics Layer",
        description: "Developed interactive Power BI dashboards for different company areas. Created automated reports and visualizations that enable data-driven decision making. Implemented key business metrics and KPIs for real-time monitoring."
      }
    };

    function showNodeDetails(nodeId) {
      console.log('Clicked node:', nodeId);
      
      // Remove active class from all nodes
      document.querySelectorAll('.pipeline-node').forEach(node => {
        node.classList.remove('active');
      });
      
      // Add active class to clicked node
      const clickedNode = document.querySelector(`[data-node="${nodeId}"]`);
      if (clickedNode) {
        clickedNode.classList.add('active');
        console.log('Added active class to node');
      }
      
      // Update details
      const details = nodeDetails[nodeId];
      if (details) {
        const titleElement = document.getElementById('detailsTitle');
        const descriptionElement = document.getElementById('detailsDescription');
        if (titleElement) {
          titleElement.textContent = details.title;
          console.log('Updated title:', details.title);
        }
        if (descriptionElement) {
          descriptionElement.textContent = details.description;
          console.log('Updated description');
        }
      }
    }

    // Make function globally available
    window.showNodeDetails = showNodeDetails;

    // Add some random status changes for realism
    setInterval(() => {
      const nodes = document.querySelectorAll('.pipeline-node');
      nodes.forEach(node => {
        if (Math.random() < 0.1) { // 10% chance
          const status = node.querySelector('.node-status');
          if (status) {
            status.style.animation = 'none';
            setTimeout(() => {
              status.style.animation = 'pulse 2s infinite';
            }, 100);
          }
        }
      });
    }, 5000);
  </script>
</Layout>
