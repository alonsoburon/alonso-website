---
import { getCollection } from 'astro:content';
import Layout from '../layouts/Layout.astro';

const posts = await getCollection('blog');
const recentPosts = posts.slice(0, 3);

function formatDate(dateString: string) {
  const date = new Date(dateString);
  return date.toLocaleDateString('en-US', {
    year: 'numeric',
    month: 'long',
    day: 'numeric'
  });
}
---

<Layout title="Alonso - Data Team Lead" description="Data Engineer and Team Lead at Datawalt. From music student to leading LATAM's best data extraction team.">
  <div class="container">
    <!-- Hero Section -->
    <section class="hero">
      <div class="hero-content">
        <h1>Data Team Lead at Datawalt</h1>
        <p class="hero-subtitle">Building LATAM's best data extraction platform</p>
        <p class="hero-description">
          Former music student who accidentally became a data engineer by helping his girlfriend with Stata homework. 
          Now leading Datawalt's first Data Engineering Cell, processing millions of records daily across LATAM. 
          Still figuring it out, but making it work.
        </p>
        <div class="hero-buttons">
          <a href="/blog" class="btn btn-primary">Read My Story</a>
          <a href="/contact" class="btn btn-secondary">Get In Touch</a>
        </div>
      </div>
    </section>


    <!-- Core Competencies -->
    <section class="core-competencies">
      <h2>Core Competencies</h2>
      <div class="competencies-grid">
        <div class="competency-card" data-skill="python" onclick="showSkillDetails('python')">
          <div class="competency-header">
            <h3>Data Engineering</h3>
            <div class="competency-level">Expert</div>
          </div>
          <p>Python, ETL pipelines, data platforms, automation. Built enterprise-grade systems processing millions of records daily.</p>
          <div class="competency-tags">
            <span class="tag">Python</span>
            <span class="tag">ETL</span>
            <span class="tag">PostgreSQL</span>
            <span class="tag">Delta Tables</span>
          </div>
        </div>

        <div class="competency-card" data-skill="leadership" onclick="showSkillDetails('leadership')">
          <div class="competency-header">
            <h3>Team Leadership</h3>
            <div class="competency-level">Advanced</div>
          </div>
          <p>Led Datawalt's first Data Engineering Cell. Experience managing technical teams, mentoring developers, and stakeholder communication.</p>
          <div class="competency-tags">
            <span class="tag">Team Management</span>
            <span class="tag">Mentoring</span>
            <span class="tag">Stakeholder Relations</span>
            <span class="tag">Strategic Planning</span>
          </div>
        </div>

        <div class="competency-card" data-skill="bi" onclick="showSkillDetails('bi')">
          <div class="competency-header">
            <h3>Business Intelligence</h3>
            <div class="competency-level">Expert</div>
          </div>
          <p>Power BI expert with LATAM client experience. Built executive dashboards and data visualization solutions for business decision-making.</p>
          <div class="competency-tags">
            <span class="tag">Power BI</span>
            <span class="tag">Data Visualization</span>
            <span class="tag">Dashboard Design</span>
            <span class="tag">Business Analytics</span>
          </div>
        </div>

        <div class="competency-card" data-skill="architecture" onclick="showSkillDetails('architecture')">
          <div class="competency-header">
            <h3>System Architecture</h3>
            <div class="competency-level">Advanced</div>
          </div>
          <p>Designed and built scalable data architectures. Strong focus on performance optimization, system reliability, and future-proofing.</p>
          <div class="competency-tags">
            <span class="tag">Data Architecture</span>
            <span class="tag">Scalability</span>
            <span class="tag">Performance</span>
            <span class="tag">Enterprise Solutions</span>
          </div>
        </div>

        <div class="competency-card" data-skill="analytics" onclick="showSkillDetails('analytics')">
          <div class="competency-header">
            <h3>Statistical Analysis</h3>
            <div class="competency-level">Advanced</div>
          </div>
          <p>Econometric analysis, statistical modeling, and data interpretation. Experience with statistical software and advanced analytical techniques.</p>
          <div class="competency-tags">
            <span class="tag">Econometrics</span>
            <span class="tag">Statistical Modeling</span>
            <span class="tag">Data Analysis</span>
            <span class="tag">R/Stata</span>
          </div>
        </div>

        <div class="competency-card" data-skill="ai" onclick="showSkillDetails('ai')">
          <div class="competency-header">
            <h3>AI Integration</h3>
            <div class="competency-level">Proficient</div>
          </div>
          <p>Leveraging LLM tools and AI technologies for automation, rapid prototyping, and productivity enhancement in data workflows.</p>
          <div class="competency-tags">
            <span class="tag">LLM Tools</span>
            <span class="tag">Automation</span>
            <span class="tag">Rapid Prototyping</span>
            <span class="tag">AI Workflows</span>
          </div>
        </div>
      </div>
    </section>

    <!-- Recent Posts -->
    <section class="recent-posts">
      <h2>Latest Articles</h2>
      <div class="posts-grid">
        {recentPosts.map((post) => (
          <article class="post-card">
            <h3><a href={`/blog/${post.slug}`}>{post.data.title}</a></h3>
            <p class="post-meta">{formatDate(post.data.date)}</p>
            <p>{post.data.description || 'Article about data engineering and analysis.'}</p>
          </article>
        ))}
      </div>
      <div class="text-center">
        <a href="/blog" class="btn btn-outline">View All Articles</a>
      </div>
    </section>
  </div>

  <style>
    /* Hero Section */
    .hero {
      text-align: center;
      padding: 4rem 0;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      margin: -2rem 0 4rem 0;
      border-radius: 0 0 0 0;
    }

    .hero-content {
      max-width: 800px;
      margin: 0 auto;
      padding: 0 1rem;
    }

    .hero h1 {
      font-size: 3.5rem;
      font-weight: 700;
      margin-bottom: 1rem;
    }

    .hero-subtitle {
      font-size: 1.5rem;
      font-weight: 300;
      margin-bottom: 1rem;
      opacity: 0.9;
    }

    .hero-description {
      font-size: 1.1rem;
      margin-bottom: 2rem;
      opacity: 0.8;
      line-height: 1.7;
    }

    .hero-buttons {
      display: flex;
      gap: 1rem;
      justify-content: center;
      flex-wrap: wrap;
    }

    /* Buttons */
    .btn {
      display: inline-block;
      padding: 0.75rem 1.5rem;
      border-radius: 0.5rem;
      text-decoration: none;
      font-weight: 600;
      transition: all 0.3s;
      border: 2px solid transparent;
    }

    .btn-primary {
      background: white;
      color: #667eea;
    }

    .btn-primary:hover {
      background: #f8f9fa;
      transform: translateY(-2px);
    }

    .btn-secondary {
      background: transparent;
      color: white;
      border-color: white;
    }

    .btn-secondary:hover {
      background: white;
      color: #667eea;
    }

    .btn-outline {
      background: transparent;
      color: #58a6ff;
      border-color: #58a6ff;
    }

    .btn-outline:hover {
      background: #58a6ff;
      color: white;
    }

    /* Sections */
    section {
      margin-bottom: 4rem;
    }

    h2 {
      font-size: 2.5rem;
      font-weight: 700;
      text-align: center;
      margin-bottom: 3rem;
      color: #f0f6fc;
    }

    /* Interactive Personal Journey Section */
    .pipeline-demo {
      padding: 4rem 0;
      background: linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #0f172a 100%);
      color: white;
      position: relative;
      overflow: visible;
    }

    .pipeline-demo::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: radial-gradient(circle at 20% 50%, rgba(88, 166, 255, 0.1) 0%, transparent 50%),
                  radial-gradient(circle at 80% 20%, rgba(16, 185, 129, 0.1) 0%, transparent 50%),
                  radial-gradient(circle at 40% 80%, rgba(139, 92, 246, 0.1) 0%, transparent 50%);
      pointer-events: none;
    }

    .pipeline-demo h2 {
      text-align: center;
      font-size: 2.5rem;
      font-weight: 700;
      color: #f1f5f9;
      margin-bottom: 3rem;
      position: relative;
      z-index: 1;
    }

    .core-competencies {
      padding: 4rem 0;
      background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
    }

    .core-competencies h2 {
      text-align: center;
      font-size: 2.5rem;
      font-weight: 700;
      color: #f1f5f9;
      margin-bottom: 3rem;
      text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
    }

    .competencies-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
      gap: 2rem;
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 2rem;
    }

    .competency-card {
      background: linear-gradient(145deg, #1e293b 0%, #334155 100%);
      border: 1px solid #475569;
      border-radius: 12px;
      padding: 2rem;
      transition: all 0.3s ease;
      cursor: pointer;
      position: relative;
      overflow: hidden;
    }

    .competency-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.05), transparent);
      transition: left 0.6s ease;
    }

    .competency-card:hover::before {
      left: 100%;
    }

    .competency-card:hover {
      border-color: #58a6ff;
      box-shadow: 0 8px 32px rgba(88, 166, 255, 0.2);
      transform: translateY(-4px);
    }

    .competency-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1rem;
    }

    .competency-header h3 {
      font-size: 1.3rem;
      font-weight: 600;
      color: #f1f5f9;
      margin: 0;
    }

    .competency-level {
      background: linear-gradient(135deg, #10b981 0%, #059669 100%);
      color: white;
      padding: 0.3rem 0.8rem;
      border-radius: 20px;
      font-size: 0.8rem;
      font-weight: 500;
    }

    .competency-card p {
      color: #94a3b8;
      line-height: 1.6;
      margin-bottom: 1.5rem;
      font-size: 0.95rem;
    }

    .competency-tags {
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
    }

    .tag {
      background: linear-gradient(135deg, #334155 0%, #475569 100%);
      color: #10b981;
      padding: 0.4rem 0.8rem;
      border-radius: 6px;
      font-size: 0.8rem;
      font-weight: 500;
      border: 1px solid rgba(16, 185, 129, 0.2);
      transition: all 0.3s ease;
    }

    .tag:hover {
      background: linear-gradient(135deg, #10b981 0%, #059669 100%);
      color: white;
      transform: translateY(-1px);
    }

    .pipeline-node {
      background: linear-gradient(145deg, #1e293b 0%, #334155 100%);
      border: 2px solid #475569;
      border-radius: 16px;
      padding: 1.5rem;
      width: 280px;
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      cursor: pointer;
      position: relative;
      overflow: hidden;
      flex-shrink: 0;
      backdrop-filter: blur(10px);
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
      z-index: 1;
    }

    .pipeline-node::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
      transition: left 0.6s ease;
    }

    .pipeline-node:hover::before {
      left: 100%;
    }

    .pipeline-node:hover {
      border-color: #58a6ff;
      box-shadow: 0 12px 40px rgba(88, 166, 255, 0.3), 0 0 0 1px rgba(88, 166, 255, 0.2);
      transform: translateY(-8px) scale(1.02);
    }

    .pipeline-node.active {
      border-color: #10b981;
      box-shadow: 0 12px 40px rgba(16, 185, 129, 0.4), 0 0 0 1px rgba(16, 185, 129, 0.3);
      transform: translateY(-4px) scale(1.01);
    }

    .node-header {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      margin-bottom: 1rem;
    }

    .node-status {
      width: 12px;
      height: 12px;
      border-radius: 50%;
      animation: pulse 2s infinite;
      position: relative;
    }

    .node-status::after {
      content: '';
      position: absolute;
      top: -2px;
      left: -2px;
      right: -2px;
      bottom: -2px;
      border-radius: 50%;
      background: inherit;
      opacity: 0.3;
      animation: ripple 2s infinite;
    }

    .status-success {
      background: #10b981;
      box-shadow: 0 0 15px rgba(16, 185, 129, 0.6);
    }

    .node-icon {
      font-size: 1.8rem;
      filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3));
      transition: transform 0.3s ease;
    }

    .pipeline-node:hover .node-icon {
      transform: scale(1.1) rotate(5deg);
    }

    .node-content h3 {
      font-size: 1.2rem;
      font-weight: 600;
      color: #f1f5f9;
      margin-bottom: 0.5rem;
      text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
    }

    .node-content p {
      color: #94a3b8;
      font-size: 0.9rem;
      margin-bottom: 1rem;
      line-height: 1.4;
    }


    .connection-line {
      position: absolute;
      background: linear-gradient(45deg, transparent 0%, #10b981 20%, #10b981 80%, transparent 100%);
      height: 2px;
      z-index: -1;
      animation: flow 3s ease-in-out infinite;
    }

    .top-left-to-center {
      top: 50%;
      left: 50%;
      width: 200px;
      transform: translate(-50%, -50%) rotate(-45deg);
      transform-origin: center;
    }

    .top-center-to-center {
      top: 50%;
      left: 50%;
      width: 150px;
      transform: translate(-50%, -50%) rotate(-90deg);
      transform-origin: center;
    }

    .top-right-to-center {
      top: 50%;
      left: 50%;
      width: 200px;
      transform: translate(-50%, -50%) rotate(-135deg);
      transform-origin: center;
    }

    .left-top-to-center {
      top: 50%;
      left: 50%;
      width: 200px;
      transform: translate(-50%, -50%) rotate(45deg);
      transform-origin: center;
    }

    .left-bottom-to-center {
      top: 50%;
      left: 50%;
      width: 200px;
      transform: translate(-50%, -50%) rotate(135deg);
      transform-origin: center;
    }

    .right-top-to-center {
      top: 50%;
      left: 50%;
      width: 200px;
      transform: translate(-50%, -50%) rotate(-45deg);
      transform-origin: center;
    }

    .right-bottom-to-center {
      top: 50%;
      left: 50%;
      width: 200px;
      transform: translate(-50%, -50%) rotate(-135deg);
      transform-origin: center;
    }

    .pipeline-details {
      background: linear-gradient(145deg, #1e293b 0%, #334155 100%);
      border: 1px solid #475569;
      border-radius: 16px;
      padding: 2.5rem;
      max-width: 800px;
      margin: 0 auto;
      backdrop-filter: blur(10px);
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
      transition: all 0.3s ease;
    }

    .pipeline-details:hover {
      border-color: #58a6ff;
      box-shadow: 0 12px 40px rgba(88, 166, 255, 0.2);
    }

    .details-content h3 {
      color: #f1f5f9;
      font-size: 1.6rem;
      font-weight: 600;
      margin-bottom: 1rem;
      text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
    }

    .details-content p {
      color: #94a3b8;
      line-height: 1.7;
      font-size: 1rem;
    }

    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.5; }
    }

    @keyframes ripple {
      0% { transform: scale(1); opacity: 0.3; }
      100% { transform: scale(2); opacity: 0; }
    }

    @keyframes flow {
      0% { 
        left: -15px; 
        opacity: 0; 
      }
      10% { 
        opacity: 1; 
      }
      90% { 
        opacity: 1; 
      }
      100% { 
        left: calc(100% + 15px); 
        opacity: 0; 
      }
    }

    @keyframes shimmer {
      0% { left: -100%; }
      100% { left: 100%; }
    }

    /* Responsive */
    @media (max-width: 1200px) {
      .pipeline-container {
        flex-wrap: wrap;
        gap: 1.5rem;
        justify-content: center;
      }
      
      .pipeline-node {
        width: calc(50% - 0.75rem);
        min-width: 280px;
        max-width: 320px;
      }
      
      .pipeline-connection {
        width: 100%;
        height: 40px;
        transform: rotate(90deg);
      }
      
      .connection-line {
        height: 4px;
      }

    }

    @media (max-width: 768px) {
      .pipeline-demo {
        padding: 3rem 0;
      }
      
      .pipeline-demo h2 {
        font-size: 2rem;
        margin-bottom: 2rem;
      }
      
      .pipeline-container {
        flex-direction: column;
        gap: 2rem;
        padding: 0 0.5rem;
      }
      
      .pipeline-node {
        width: 100%;
        max-width: 350px;
        margin: 0 auto;
        padding: 1.25rem;
      }
      
      .pipeline-connection {
        transform: rotate(90deg);
        width: 6px;
        height: 50px;
      }
      
      .connection-line {
        height: 4px;
      }
      
      .pipeline-details {
        padding: 2rem;
        margin: 0 1rem;
      }
      
      .details-content h3 {
        font-size: 1.4rem;
      }

    }

    @media (max-width: 480px) {
      .pipeline-node {
        padding: 1rem;
      }
      
      .node-content h3 {
        font-size: 1.1rem;
      }
      
      .node-content p {
        font-size: 0.85rem;
      }
      
      .metric {
        font-size: 0.7rem;
        padding: 0.3rem 0.5rem;
      }

    }


    /* Recent Posts */
    .posts-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
      gap: 2rem;
      margin-bottom: 2rem;
    }

    .post-card {
      background: #161b22;
      padding: 2rem;
      border-radius: 1rem;
      box-shadow: 0 4px 6px rgba(0,0,0,0.3);
      border: 1px solid #21262d;
      transition: transform 0.3s, box-shadow 0.3s;
    }

    .post-card:hover {
      transform: translateY(-4px);
      box-shadow: 0 8px 25px rgba(0,0,0,0.4);
      border-color: #58a6ff;
    }

    .post-card h3 {
      font-size: 1.25rem;
      font-weight: 600;
      margin-bottom: 0.5rem;
    }

    .post-card h3 a {
      color: #f0f6fc;
      text-decoration: none;
    }

    .post-card h3 a:hover {
      color: #58a6ff;
    }

    .post-meta {
      color: #8b949e;
      font-size: 0.875rem;
      margin-bottom: 1rem;
    }

    .text-center {
      text-align: center;
    }

    /* Responsive */
    @media (max-width: 768px) {
      .hero h1 {
        font-size: 2.5rem;
      }

      .hero-subtitle {
        font-size: 1.25rem;
      }

      .hero-buttons {
        flex-direction: column;
        align-items: center;
      }

      .timeline::before {
        left: 1rem;
      }

      .timeline-item {
        padding-left: 3rem;
      }

      .timeline-marker {
        left: 0.25rem;
      }

      .posts-grid {
        grid-template-columns: 1fr;
      }
    }
  </style>

  <script is:inline>

    const skillDetails = {
      'python': {
        title: "Data Engineering",
        description: "Expert in Python for data engineering, ETL pipelines, and automation. Built custom data platforms processing millions of records daily. Experience with pandas, pyarrow, Delta tables, and enterprise-grade data processing workflows."
      },
      'leadership': {
        title: "Team Leadership",
        description: "Led Datawalt's first Data Engineering Cell. Experience managing technical teams, mentoring developers, and stakeholder communication. Proven track record in building and scaling data teams in fast-growing environments."
      },
      'bi': {
        title: "Business Intelligence",
        description: "Expert in Power BI dashboard development and data visualization. Built executive-level dashboards for LATAM clients, turning raw data into actionable business insights and strategic recommendations."
      },
      'architecture': {
        title: "System Architecture",
        description: "Expert in designing scalable data architectures and enterprise solutions. Built Warp platform processing millions of records daily. Strong focus on performance optimization, system reliability, and future-proofing."
      },
      'analytics': {
        title: "Statistical Analysis",
        description: "Expert in econometric analysis, statistical modeling, and data interpretation. Experience with statistical software and advanced analytical techniques for business intelligence and decision-making."
      },
      'ai': {
        title: "AI Integration",
        description: "Proficient in leveraging LLM tools and AI technologies for automation, rapid prototyping, and productivity enhancement. Experience integrating AI solutions into data workflows and business processes."
      }
    };


    function showSkillDetails(skillId) {
      console.log('Clicked skill:', skillId);
      
      // Remove active class from all competency cards
      document.querySelectorAll('.competency-card').forEach(node => {
        node.classList.remove('active');
      });
      
      // Add active class to clicked competency card
      const clickedSkill = document.querySelector(`[data-skill="${skillId}"]`);
      if (clickedSkill) {
        clickedSkill.classList.add('active');
        console.log('Added active class to competency card');
      }
      
      // Update skill details
      const details = skillDetails[skillId];
      if (details) {
        const titleElement = document.getElementById('skillTitle');
        const descriptionElement = document.getElementById('skillDescription');
        if (titleElement) {
          titleElement.textContent = details.title;
          console.log('Updated skill title:', details.title);
        }
        if (descriptionElement) {
          descriptionElement.textContent = details.description;
          console.log('Updated skill description');
        }
      }
    }

    // Make function globally available
    window.showSkillDetails = showSkillDetails;

    // Add some random status changes for realism
    setInterval(() => {
      const nodes = document.querySelectorAll('.pipeline-node');
      nodes.forEach(node => {
        if (Math.random() < 0.1) { // 10% chance
          const status = node.querySelector('.node-status');
          if (status) {
            status.style.animation = 'none';
            setTimeout(() => {
              status.style.animation = 'pulse 2s infinite';
            }, 100);
          }
        }
      });
    }, 5000);
  </script>
</Layout>

  </script>
</Layout>
